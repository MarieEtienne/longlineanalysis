{
    "contents" : "### read Data \n#mainDir <- '/media/metienne_h/Consulting/DFO/2015-YelloweyeSurvey'\n#mainDir <- '/home/metienne/bianca/Consulting/DFO/2015-YelloweyeSurvey/'\nmainDir <- '/home/metienne/EnCours/2015-YelloweyeSurvey'\ndataDir <- 'Data'\nresDir <- 'Results/PHMA'\ncodeDir <- 'DFOYellowEye'\n\n\nlibrary('rjags')\nlibrary('longline')\nlibrary('stringr')\nlibrary('ggplot2')\nlibrary('scales')\nlibrary('parallel')\n\nsource(file.path(mainDir, codeDir,\"glmFunction.R\"))\nsource(file.path(mainDir, codeDir, 'formattingFunction.R'))\nnIter <- 5000\n\nregion <- 'South'\nresDir <- paste0(resDir, region)\nif(!file.exists(file.path(mainDir, resDir)))\n  dir.create(file.path(mainDir, resDir))\n\ndepthBreaks = c(0, 101, 201,  801 )\n### \n\n\n\n# Prepare Data Set --------------------------------------------------------\n\nPHMAData <- read.table(file.path(mainDir, dataDir, 'PHMALonglineSurveysForMarie.csv'),\n                       sep=\",\", header=T)\nind <- which(str_detect(PHMAData$Survey, paste0('PHMA Rockfish Longline Survey - Outside ', region)))\nPHMAData <- PHMAData[ind, ]\n\nPHMAData <- PHMAData[,which(names(PHMAData)%in% c(\"Year\", \"Depth\", \"soaktime\", \"NT\", \"NNT\", \n                                                  \"Nb\", \"Ne\"))]\nPHMAData$Fact2 <- splitInClasses(data = PHMAData$Depth, depthBreaks)\nPHMAData$Fact1 <- PHMAData$Year\n\ntable(PHMAData$Fact1)\nsummary(PHMAData)\n\n### \n\n\n# Examining different case -- parallelized version ------------------------\n\ndifferentCase<- expand.grid(depth=c(T,F), constPe=c(T,F))\n\nmclapply(1:nrow(differentCase),mc.cores = 2, \n         function(i){\n           case <- differentCase[i,]\n           resDir <- file.path(resDir, 'YearEffect')\n           resDir <- ifelse(case$depth, paste0(resDir,'AccountedForDepth'), resDir)\n           resDir <- ifelse(case$constPe, paste0(resDir,'NonConstPe'), resDir)\n           if(!file.exists(file.path(mainDir, resDir)))\n             dir.create(file.path(mainDir, resDir))\n           if(case$depth){\n             longline.PHMA <-  longline(fact1 = PHMAData$Fact1,\n                                        fact2 = PHMAData$Fact2,\n                                        nt = PHMAData$NT, nnt = PHMAData$NNT, nb = PHMAData$Nb,\n                                        ne = PHMAData$Ne, s = PHMAData$soaktime)\n           } else{\n             longline.PHMA <-  longline(fact1 = PHMAData$Fact1,\n                                        fact2 = PHMAData$Fact2,\n                                        nt = PHMAData$NT, nnt = PHMAData$NNT, nb = PHMAData$Nb,\n                                        ne = PHMAData$Ne, s = PHMAData$soaktime)           \n           }\n           \n           CPUE <- ComputeCPUE.longline(longline.PHMA)\n           \n           summary(longline.PHMA)\n           \n           posIndices <- lapply(1:2, function(m){ \n             RunBayesEstimation(llData = longline.PHMA, MEM = m, peConst = case$constPe, filePath =   file.path(mainDir,resDir), nIter = nIter, burnin = 10, parPrior=c(1,1))\n           }\n           )\n         }\n)\n         \n         ",
    "created" : 1426141023178.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3242681329",
    "id" : "2DCC71BB",
    "lastKnownWriteTime" : 1426591504,
    "path" : "~/EnCours/2015-YelloweyeSurvey/DFOYellowEye/PHMAAnalysiswithJags.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}